@*
 * Copyright 2021 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.govukfrontend.views.html.components._
@import uk.gov.hmrc.plasticpackagingtax.registration.controllers.routes._
@import uk.gov.hmrc.plasticpackagingtax.registration.views.html.components._
@import uk.gov.hmrc.plasticpackagingtax.registration.views.html.main_template
@import uk.gov.hmrc.plasticpackagingtax.registration.views.model.Title
@import uk.gov.hmrc.plasticpackagingtax.registration.views.model.TaskStatus
@import uk.gov.hmrc.plasticpackagingtax.registration.views.model.TaskName


@this(
govukLayout: main_template,
pageTitle: pageTitle,
paragraphBody: paragraphBody,
govukButton: GovukButton,
link: link,
govukTag: GovukTag
)

@(tasks: Map[TaskName, TaskStatus])(implicit request: Request[_], messages: Messages)

@task(index: Int, title: String, linkText: String, linkTargetUrl: String, status: TaskStatus) = {
<h2 class="app-task-list__section">
    <span class="app-task-list__section-number">@{index}.</span>
    @messages(title)
</h2>
<div class="app-task-list__items no-item-padding">
    <div class="app-task-list__item">
                        <span class='app-task-list__task-name'>
                            @link(text = messages(linkText), call = Call("GET", linkTargetUrl))
                        </span>
        @getTag(status)
    </div>
</div>
}

@getTag(status: TaskStatus) = {
@status match {
case TaskStatus.Completed => {@govukTag(Tag(content = Text(messages("task.status.completed")), classes = "govuk-tag app-task-list__task-completed"))}
case TaskStatus.InProgress => {@govukTag(Tag(content = Text(messages("task.status.inProgress")), classes = "govuk-tag govuk-tag--to-do app-task-list__task-completed govuk-tag--red"))}
case TaskStatus.NotStarted => {@govukTag(Tag(content = Text(messages("task.status.notStarted")), classes = "govuk-tag govuk-tag--to-do app-task-list__task-completed govuk-tag--grey"))}
case _ => {@govukTag(Tag(content = Text(messages("task.status.notStarted")), classes = "govuk-tag govuk-tag--to-do app-task-list__task-completed govuk-tag--grey"))}
}
}

@getStatus(taskName: TaskName) = @{
tasks.getOrElse(taskName, TaskStatus.NotStarted)
}

@govukLayout(title = Title("registrationPage.title")) {

@pageTitle(text = messages("registrationPage.title"))

<ol class="app-task-list">

    <li>
        @task(1, "registrationPage.organisationDetails", "registrationPage.businessInfo", "http://businessInfo",
        getStatus(TaskName.OrganisationDetails))
    </li>
    <li>
        @task(2, "registrationPage.plasticPackagingDetails", "registrationPage.plasticPackagingInfo",
        "http://plasticPackagingInfo", getStatus(TaskName.PlasticPackagingDetails))
    </li>
    <li>
        @task(3, "registrationPage.businessContactDetails", "registrationPage.businessContactInfo",
        "http://businessContactInfo", getStatus(TaskName.BusinessContactDetails))
    </li>
    <li>
        @task(4, "registrationPage.applicantContactDetails", "registrationPage.applicantContactInfo",
        "http://applicantContactInfo", getStatus(TaskName.ApplicantContactDetails))
    </li>

</ol>

<h2 id="review-declaration" class="govuk-heading-m">@messages("registrationPage.declaration.header")</h2>
@paragraphBody(message = messages("registrationPage.declaration.description"), id = Some("review-declaration-element"))
@govukButton(
Button(
href = Some(""),
isStartButton = true,
content = Text(messages("registrationPage.declaration.buttonName"))
)
)
}